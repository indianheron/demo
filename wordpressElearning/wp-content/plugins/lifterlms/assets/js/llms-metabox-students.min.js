!function(t,n){window.llms=window.llms||{};var e=function(){this.init=function(){var n=["course","llms_membership"];window.llms.post.post_type&&-1!==n.indexOf(window.llms.post.post_type)&&(this.$metabox=t("#lifterlms-students"),this.bind())},this.bind=function(){var n=this;this.$metabox.on("click","a.llms-remove-student",function(e){e.preventDefault(),n.remove_student(t(this))}),this.$metabox.on("click","a.llms-add-student",function(e){e.preventDefault(),n.add_student(t(this))}),t("#llms-add-student-select").llmsStudentsSelect2({multiple:!0}),t("#llms-enroll-students").on("click",function(){n.enroll_students(t(this))})},this.add_student=function(t){this.update_student_enrollment(t.attr("data-id"),"add")},this.enroll_students=function(n){var e=t("#llms-add-student-select"),s=e.val(),l=this.$metabox.find(".llms-metabox-students-add-new");LLMS.Spinner.start(l),window.LLMS.Ajax.call({data:{action:"bulk_enroll_students",student_ids:s},beforeSend:function(t){s||(n.before('<span class="llms-error">'+LLMS.l10n.translate("Please select a student to enroll")+"</span>"),t.abort(),LLMS.Spinner.stop(l))},success:function(n){e.val(null).trigger("change"),LLMS.Spinner.stop(l),window.llms.admin_tables.reload(t("#llms-gb-table-student-management"))}})},this.remove_student=function(t){this.update_student_enrollment(t.attr("data-id"),"remove")},this.update_student_enrollment=function(n,e){var s=t("#llms-gb-table-student-management"),l=s.closest(".llms-table-wrap");LLMS.Spinner.start(l),window.LLMS.Ajax.call({data:{action:"update_student_enrollment",status:e,student_id:n},success:function(){window.llms.admin_tables.reload(s)}})},this.init()};window.llms.MetaboxStudents=new e}(jQuery);